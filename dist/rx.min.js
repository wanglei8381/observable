!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Rx={})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0},o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},u=Object.prototype,c=function(e){return u.toString.call(e)};function a(e){return void 0===e}function l(e){var r=void 0===e?"undefined":t(e);return null!=e&&("object"===r||"function"===r)}function h(e){return null!=e&&"object"===(void 0===e?"undefined":t(e))}var f=9007199254740991;function p(e){return null!==e&&"function"!=typeof e&&("number"==typeof(t=e.length)&&t>-1&&t<=f&&t%1==0);var t}function v(e){if(!l(e))return!1;var t=c(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object Proxy]"===t}function y(e){return e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var d=0,b={},_=0;var m,k,O=(m=void 0,k=void 0,void 0!==g?(m=g,k=w):"undefined"!=typeof webkitRequestAnimationFrame?(m=webkitRequestAnimationFrame,k=webkitCancelAnimationFrame):"undefined"!=typeof msRequestAnimationFrame?(m=msRequestAnimationFrame,k=msCancelAnimationFrame):"undefined"!=typeof mozRequestAnimationFrame?(m=mozRequestAnimationFrame,k=mozCancelAnimationFrame):"undefined"!=typeof oRequestAnimationFrame?(m=oRequestAnimationFrame,k=oCancelAnimationFrame):(m=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-_)),n=setTimeout(function(){e(t+r)},r);return _=t+r,n},k=clearTimeout),{raf:m,caf:k}),g=O.raf,w=O.caf,x=function(e){function t(){r(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"object unsubscribed"));return e.name="ObjectUnsubscribedError",Object.setPrototypeOf(e,t.prototype),e}return o(t,e),t}(Error),j=function(e){function t(){r(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"argument out of range"));return e.name="ArgumentOutOfRangeError",Object.setPrototypeOf(e,t.prototype),e}return o(t,e),t}(Error),S=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;r(this,e),this.SchedulerAction=t,this.now=n}return n(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2];return new this.SchedulerAction(this,e).schedule(r,t)}}]),e}();S.now=Date.now;var P=function(){function e(){r(this,e),this.set=Object.create(null)}return n(e,[{key:"add",value:function(e){this.set[e]=!0}},{key:"delete",value:function(e){this.has(e)&&delete this.set[e]}},{key:"has",value:function(e){return!0===this.set[e]}},{key:"clear",value:function(){this.set=Object.create(null)}}]),e}(),E=["next","error","complete"];function I(e){return function(t){var r={next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){t.complete()}},n=e(t);if(!a(n)){if(v(n))r.next=n;else if(n instanceof R)r=n;else if(l(n))for(var i=0;i<3;i++){var o=E[i];v(n[o])&&(r[o]=n[o])}var s=M(r);t.add(s),this.source.subscribe(s)}}}var A=0,N=function(){function e(){r(this,e),this._closed=!1,this._uid=A++,this._set=new P,this.observers=[]}return n(e,[{key:"unsubscribe",value:function(){if(!this.closed){this._unsubscribe&&this._unsubscribe(),this._closed=!0;for(var e=this.observers,t=0;t<e.length;t++){var r=e[t];!0!==r.closed&&r.unsubscribe()}this._set.clear(),this.observers=[]}}},{key:"add",value:function(t){if(t===this)return this;v(t)?this._add({_uid:A++,unsubscribe:t}):t instanceof e&&this._add(t)}},{key:"_add",value:function(e){var t=this._set,r=this.observers;t.has(e._uid)||(t.add(A),r.push(e))}},{key:"remove",value:function(e){var t=this._set,r=this.observers;e&&e._uid&&t.has(e._uid)&&r.splice(r.indexOf(e),1)}},{key:"closed",get:function(){return this._closed}}]),e}();function T(e){var t=void 0;return"function"==typeof Symbol?Symbol.observable?t=Symbol.observable:(t=Symbol(e),Symbol.observable=t):t="@@"+e,t}var F=function(){if("function"==typeof Symbol)return Symbol.iterator||(Symbol.iterator=Symbol("iterator polyfill")),Symbol.iterator;if("undefined"!=typeof Set&&"function"==typeof(new Set)["@@iterator"])return"@@iterator";if("undefined"!=typeof Map)for(var e=Object.getOwnPropertyNames(Map.prototype),t=0;t<e.length;++t){var r=e[t];if("entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries)return r}return"@@iterator"}(),C=T("observable"),q=T("rxSubscriber"),R=function(e){function t(e,n,i){r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return h(e)?o.destination=e:o.destination={next:e&&e.bind(o),error:n&&n.bind(o),complete:i&&i.bind(o)},o.isStopped=!0,o}return o(t,N),n(t,[{key:"next",value:function(e){if(this.isStopped)try{this._next(e)}catch(e){this.unsubscribe(),this.errorSource="next",this.errorValue=e}}},{key:"error",value:function(e){if(this.isStopped)try{this._error(e)}catch(e){throw this.unsubscribe(),this.errorSource="error",e}}},{key:"complete",value:function(){if(this.isStopped)try{this._complete()}catch(e){throw this.unsubscribe(),this.errorSource="complete",e}}},{key:"add",value:function(e){this.isStopped?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e):v(e)?e():e instanceof N&&e.unsubscribe()}},{key:"_next",value:function(e){this.destination.next&&this.destination.next(e)}},{key:"_error",value:function(e){if(!this.destination.error)throw this.unsubscribe(),this.errorSource="error",e;this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete&&this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.isStopped=!1}}],[{key:"create",value:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return new(Function.prototype.bind.apply(t,[null].concat(r)))}}]),t}(),V=new R;function M(e,t,r){var n=e;return null==e?V:e instanceof R?e:(e[q]&&(n=e[q]()),new R(n,t,r))}var Y=function(){function e(t){r(this,e),t&&(this._subscribe=t),this._isScalar=!1}return n(e,[{key:"lift",value:function(t){var r=new e;return r.source=this,r.operator=I(t),r}},{key:"subscribe",value:function(e,t,r){var n=M(e,t,r);if(this.operator?this.operator(n):this._subscribe&&n.add(this.source?this._subscribe(n):this._trySubscribe(n)),n.errorValue&&"next"===n.errorSource)throw n.errorValue;return n}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.syncError=t,e.error(t)}}},{key:"_subscribe",value:function(e){return this.source.subscribe(e)}},{key:C,value:function(){return this}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),z=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.array=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.array,n=this.scheduler,i=r.length;if(n)n.schedule(t.dispatch,0,{array:r,observer:e,index:0,count:i});else{for(var o=0;o<i;o++)e.next(r[o]);e.complete()}}}],[{key:"create",value:function(e,r){return new t(e,r)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.index,n=e.array;r>=e.count?t.complete():(t.next(n[r]),t.closed||(e.index=r+1,this.schedule(e)))}}]),t}(),B=function(e){function t(e){r(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.scheduler=e,n}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.scheduler;if(r)return r.schedule(t.dispatch,0,{observer:e});e.complete()}}],[{key:"create",value:function(e){return new t(e)}},{key:"dispatch",value:function(e){e.observer.complete()}}]),t}(),G=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.value=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.value,n=this.scheduler;n?n.schedule(t.dispatch,0,{observer:e,value:r}):(e.next(r),e.complete())}}],[{key:"create",value:function(e,r){return new t(e,r)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.value;t.next(r),t.complete()}}]),t}(),D=B.create,U=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.error=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.scheduler,n=this.error;if(r)return r.schedule(t.dispatch,0,{observer:e,error:n});e.error(n)}}],[{key:"create",value:function(e){return new t(e)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.error;t.error(r)}}]),t}().create,H=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.promise=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this,n=this.promise,i=this.scheduler;i?this._isScalar?i.schedule(t.dispatch,0,{observer:e,value:this.value}):n.then(function(n){r._isScalar=!0,r.value=n,i.schedule(t.dispatch,0,{observer:e,value:n})},function(t){i.schedule(function(e){var t=e.observer,r=e.error;t.error(r)},0,{observer:e,error:t})}).catch(function(e){setTimeout(function(){throw e})}):this._isScalar?(e.next(this.value),e.complete()):n.then(function(t){r._isScalar=!0,r.value=t,e.next(t),e.complete()},function(t){e.error(t)}).catch(function(e){setTimeout(function(){throw e})})}}],[{key:"create",value:function(e,r){return new t(e,r)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.value;t.next(r),t.complete()}}]),t}(),J=H.create,K=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.array=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.array,n=this.scheduler,i=r.length;if(n)n.schedule(t.dispatch,0,{array:r,observer:e,index:0,count:i});else{for(var o=0;o<i;o++)e.next(r[o]);e.complete()}}}],[{key:"create",value:function(e,r){var n=e.length;return 0===n?new B(r):1===n?new G(e[0],r):new t(e,r)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.index,n=e.array;r>=e.count?t.complete():(t.next(n[r]),t.closed||(e.index=r+1,this.schedule(e)))}}]),t}(),L=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(null==e)throw new Error("iterator cannot be null.");if(!e[F])throw new TypeError("object is not iterable");return i.iteratorObject=e,i.scheduler=n,i}return o(t,Y),n(t,[{key:"_subscribe",value:function(e){var r=this.iteratorObject,n=this.scheduler,i=function(e){var t=e[F];if(!t&&"string"==typeof e)return new Q(e);if(!t&&void 0!==e.length)return new W(e);if(!t)throw new TypeError("object is not iterable");return e[F]()}(r);if(n)return n.schedule(t.dispatch,0,{observer:e,iterator:i,index:0});for(;;){var o=i.next();if(o.done){e.complete();break}if(e.next(o.value),e.closed){"function"==typeof i.return&&i.return();break}}}}],[{key:"create",value:function(e,r){return new t(e,r)}},{key:"dispatch",value:function(e){var t=e.observer,r=e.iterator,n=e.index,i=r.next();i.done?t.complete():(t.next(i.value),e.index=n+1,t.closed?"function"==typeof r.return&&r.return():this.schedule(e))}}]),t}(),Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;r(this,e),this.str=t,this.idx=n,this.len=i}return n(e,[{key:"next",value:function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}}},{key:F,value:function(){return this}}]),e}(),W=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;r(this,e),this.array=t,this.idx=n,this.len=i}return n(e,[{key:"next",value:function(){return this.idx<this.len?{done:!1,value:this.array[this.idx++]}:{done:!0,value:void 0}}},{key:F,value:function(){return this}}]),e}();var X=function(){function e(t,n,i){r(this,e),this.kind=t,this.value=n,this.error=i,this.hasValue="N"===t}return n(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,r){this.observe({next:e,error:t,complete:r})}},{key:"accept",value:function(e,t,r){h(e)?this.observe(e):this.do(e,t,r)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Y.of(this.value);case"E":return Y.throw(this.error);case"C":return Y.empty()}throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return a(t)?e.undefinedValueNotification:new e("N",t)}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}();X.completeNotification=new X("C"),X.undefinedValueNotification=new X("N",void 0);var Z=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.scheduler=n,o.delay=i,o}return o(t,R),n(t,[{key:"scheduleMessage",value:function(e){this.add(this.scheduler.schedule(t.dispatch,this.delay,{notification:e,destination:this.destination}))}},{key:"_next",value:function(e){this.scheduleMessage(X.createNext(e))}},{key:"_error",value:function(e){this.scheduleMessage(X.createError(e))}},{key:"_complete",value:function(){this.scheduleMessage(X.createComplete())}}],[{key:"dispatch",value:function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()}}]),t}(),$=function(e){function i(e,t){r(this,i);var n=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n.ish=e,n.scheduler=t,n}return o(i,Y),n(i,[{key:"_subscribe",value:function(e){var t=this.ish,r=this.scheduler;return null==r?t[C]().subscribe(e):t[C]().subscribe(new Z(e,r,0))}}],[{key:"create",value:function(e,r){if(null!=e){if(v(e[C]))return e instanceof Y&&!r?e:new i(e,r);if(o=e,Array.isArray(o))return new z(e,r);if(y(e))return new H(e,r);if(v(e[F])||("string"===(void 0===(n=e)?"undefined":t(n))||n instanceof String))return new L(e,r);if(p(e))return K.create(e,r)}var n,o;throw new TypeError((null!==e&&(void 0===e?"undefined":t(e))||e)+" is not observable")}}]),i}().create;Y.of=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t[t.length-1];null!=(n=i)&&n instanceof S?t.pop():i=null;var o=t.length;return 1===o?new G(t[0],i):o>1?new z(t,i):new B(i)},Y.empty=D,Y.throw=U,Y.fromPromise=J,Y.from=$,Y.range=function(e,t,r){for(var n=[],i=e;i<=t;i++)n.push(i);return new z(n,r)};function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){var r=[],n=0,i=0;return{next:function(o){r.push({type:"N",value:o}),n++,function o(){var s=r.shift();"N"===s.type?setTimeout(function(){i++,t.next(s.value),n===i&&r.length>0&&o()},e):"E"===s.type?t.error(s.value):t.complete()}()},error:function(e){r.push({type:"E",value:e})},complete:function(){r.push({type:"C"})}}}}var te=function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,R),n(t,[{key:"notifyNext",value:function(e,t,r,n,i){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),t}(),re=function(e){function t(e,n,i){r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.parent=e,o.outerValue=n,o.outerIndex=i,o.index=0,o}return o(t,R),n(t,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}();function ne(e,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return("number"===(void 0===(n=r)?"undefined":t(n))||n instanceof Number)&&(i=r,r=null),function(t){return new ie(t,e,r,i)}}var ie=function(e){function t(e,n,i,o){r(this,t);var u=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.project=n,u.resultSelector=i,u.concurrent=o,u.index=0,u.hasCompleted=!1,u.buffer=[],u.active=0,u}return o(t,te),n(t,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){try{var r=this.index++,n=this.project(e,r);this.active++,this._innerSub(n,e,r)}catch(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_error",this).call(this,e)}}},{key:"_innerSub",value:function(e,t,r){this.add(function(e,t,r,n){var i=new re(e,r,n);if(i.closed)return null;if(t instanceof Y)return t._isScalar?(i.next(t.value),i.complete(),null):t.subscribe(i);if(p(t)){for(var o=0,s=t.length;o<s&&!i.closed;o++)i.next(t[o]);i.closed||i.complete()}else{if(y(t))return t.then(function(e){i.closed||(i.next(e),i.complete())},function(e){return i.error(e)}).catch(function(e){setTimeout(function(){throw e})}),i;if(t&&"function"==typeof t[F])for(var u=t[F]();;){var c=u.next();if(c.done){i.complete();break}if(i.next(c.value),i.closed)break}else if(t&&"function"==typeof t[C]){var a=t[C]();if("function"==typeof a.subscribe)return a.subscribe(new re(e,r,n));i.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var h="You provided "+(l(t)?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";i.error(new TypeError(h))}}return null}(this,e,t,r))}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,r,n){this.resultSelector?this._notifyResultSelector(e,t,r,n):this.destination.next(t)}},{key:"_notifyResultSelector",value:function(e,t,r,n){try{var i=this.resultSelector(e,t,r,n);this.destination.next(i)}catch(e){this.destination.error(e)}}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),t}();Y.prototype.do=function(e,t,r){return this.lift((n=e,i=t,o=r,function(e){return{next:function(t){n&&n(t),e.next(t)},error:function(t){i&&i(t),e.error(t)},complete:function(){o&&o(),e.complete()}}}));var n,i,o},Y.prototype.delay=function(e,t,r){return this.lift(ee(e,t,r))},Y.prototype.take=function(e){return this.lift(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(e<0)throw new j;return function(t){var r=0;return 0===e?t.complete():function(n){++r>e?t.complete():(t.next(n),r===e&&t.complete())}}}(e))},Y.prototype.filter=function(e,t){return this.lift((r=e,n=t,i=0,function(e){return function(t){try{r.call(n,t,i++)&&e.next(t)}catch(t){e.error(t)}}}));var r,n,i},Y.prototype.map=function(e,t){return this.lift(function(e,t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");var r=0;return function(n){return function(i){try{n.next(e.call(t,i,r++))}catch(e){n.error(e)}}}}(e,t))},Y.prototype.mergeMap=function(e,t,r){return this.lift(ne(e,t,r))};var oe=function(e){function t(){r(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.closed=!1,e.isStopped=!1,e.observers=[],e.hasError=!1,e.thrownError=null,e}return o(t,Y),n(t,[{key:"lift",value:function(e){var t=new se(this,this);return t.operator=I(e),t}},{key:"next",value:function(e){if(this.closed)throw new x;this.isStopped||ue(this.observers,"next",e)}},{key:"error",value:function(e){if(this.closed)throw new x;this.isStopped||(this.hasError=!0,this.thrownError=e,this.isStopped=!0,ue(this.observers,"error",e),this.observers=[])}},{key:"complete",value:function(){if(this.closed)throw new x;this.isStopped||(this.isStopped=!0,ue(this.observers,"complete"),this.observers=[])}},{key:"unsubscribe",value:function(){this.closed=!0,this.isStopped=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new x;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){var t=this;if(this.hasError)e.error(this.thrownError);else{if(!this.isStopped)return this.observers.push(e),function(){return function(e,t){if(0===e.observers.length)return;var r=e.observers.indexOf(t);-1!==r&&e.observers.splice(r,1)}(t,e)};e.complete()}}},{key:"asObservable",value:function(){var e=new Y;return e.source=this,e}},{key:q,value:function(){var e=this;return{next:function(t){e.next(t)},error:function(t){e.error(t)},complete:function(){e.complete()}}}}],[{key:"create",value:function(e,t){return new se(e,t)}}]),t}(),se=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.dest=e,i.source=n,i}return o(t,oe),n(t,[{key:"next",value:function(e){this.dest&&this.dest.next&&this.dest.next(e)}},{key:"error",value:function(e){this.dest&&this.dest.error&&this.dest.error(e)}},{key:"complete",value:function(){this.dest&&this.dest.complete&&this.dest.complete()}},{key:"_subscribe",value:function(e){if(this.source)return this.source.subscribe(e)}}]),t}();function ue(e,t,r){for(var n=e.length,i=e.slice(),o=0;o<n;o++)i[o][t](r)}var ce=function(e){function t(e){r(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._value=e,n}return o(t,oe),n(t,[{key:"next",value:function(e){this._value=e,i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_subscribe",this).call(this,e);return e.closed||e.next(this._value),r}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new x;return this._value}},{key:"value",get:function(){return this.getValue()}}]),t}(),ae=function(e){function t(){var e,n,i;r(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.value=null,i.hasNext=!1,i.hasCompleted=!1,s(i,n)}return o(t,oe),n(t,[{key:"_subscribe",value:function(e){return this.hasError?e.error(this.thrownError):this.hasCompleted&&this.hasNext&&(e.next(this.value),e.complete()),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_subscribe",this).call(this,e)}},{key:"next",value:function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)}},{key:"error",value:function(e){this.hasCompleted||i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this).call(this,e)}},{key:"complete",value:function(){this.hasCompleted=!0,this.hasNext&&i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"next",this).call(this,this.value),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"complete",this).call(this)}}]),t}(),le=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,i=arguments[2];r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._bufferSize=e<1?1:e,o._windowTime=n<1?1:n,o.scheduler=i,o._events=[],o}return o(t,oe),n(t,[{key:"next",value:function(e){this._events.push({time:this._getNow(),value:e}),this._trimBufferThenGetEvents(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){var r=this._trimBufferThenGetEvents(),n=this.scheduler;if(this.closed)throw new x;var o=void 0;this.hasError||this.isStopped||(o=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_subscribe",this).call(this,e)),n&&(e=new Z(e,n)).add(e);for(var s=r.length,u=0;u<s;u++)e.next(r[u].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}},{key:"_getNow",value:function(){return(this.scheduler||S).now()}},{key:"_trimBufferThenGetEvents",value:function(){var e=this._events,t=this._bufferSize,r=this._windowTime,n=e.length,i=this._getNow(),o=0;if(n>t&&e.splice(0,n-t),r===Number.POSITIVE_INFINITY)return e;for(n=e.length;o<n&&!(i-e[o].time<r);)o++;return e.splice(0,o),e}}]),t}(),he=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.scheduler=e,i.work=n,i}return o(t,N),n(t,[{key:"schedule",value:function(e,t){return this}}]),t}(),fe=function(e){function t(){var e,n,i;r(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.id=null,i.state=void 0,i.delay=0,i.pending=!1,s(i,n)}return o(t,he),n(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e,this.delay=t,this.pending=!0;var r=this.scheduler,n=this.id;return null!=n&&(n=this.recycleAsyncId(r,n,t)),n||(n=this.requestAsyncId(r,n,t)),this.id=n,this}},{key:"recycleAsyncId",value:function(e,t,r){if(null!==r&&this.delay===r&&!1===this.pending)return t;clearInterval(t)}},{key:"requestAsyncId",value:function(e,t,r){return setInterval(e.flush.bind(e,this),r)}},{key:"execute",value:function(e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var t=this._execute(e);if(t)return t;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e){try{this.work(e)}catch(e){return this.unsubscribe(),e}}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),t}(),pe=function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,fe),n(t,[{key:"requestAsyncId",value:function(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=o&&o>0?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,r,o):(e.actions.push(this),e.scheduled||(e.scheduled=(n=e.flush.bind(e,null),b[++d]=n,Promise.resolve().then(function(){var e=b[d];e&&e()}),d)))}},{key:"recycleAsyncId",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&n>0||null===n&&this.delay>0)return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"recycleAsyncId",this).call(this,e,r,n);0===e.actions.length&&(delete b[r],e.scheduled=void 0)}}]),t}(),ve=function(e){function t(){var e,n,i;r(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.actions=[],i.active=!1,i.scheduled=void 0,s(i,n)}return o(t,S),n(t,[{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{this.active=!0;var r=void 0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}}]),t}(),ye=new(function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,ve),n(t,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t=this.actions,r=void 0;e=e||t.shift();do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}]),t}())(pe),de=new ve(fe),be=function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,fe),n(t,[{key:"requestAsyncId",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=n&&n>0?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,r,n):(e.actions.push(this),e.scheduled||(e.scheduled=g(e.flush.bind(e,null))))}},{key:"recycleAsyncId",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&n>0||null===n&&this.delay>0)return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"recycleAsyncId",this).call(this,e,r,n);0===e.actions.length&&(w(r),e.scheduled=void 0)}}]),t}(),_e=new(function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,ve),n(t,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t=this.actions,r=void 0;e=e||t.shift();do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}]),t}())(be),me=function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,fe),n(t,[{key:"schedule",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.closed?this:r>0?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"schedule",this).call(this,e,r):(this.state=e,this.delay=r,this.scheduler.flush(this),this)}},{key:"requestAsyncId",value:function(e,r,n){return null!==n&&n>0||null===n&&this.delay>0?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,r,n):e.flush(this)}}]),t}(),ke={async:de,asap:ye,animationFrame:_e,queue:new(function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,ve),t}())(me)};e.Observable=Y,e.ArgumentOutOfRangeError=j,e.ObjectUnsubscribedError=x,e.Subscriber=R,e.emptySubscriber=V,e.toSubscriber=M,e.Subscription=N,e.Subject=oe,e.AnonymousSubject=se,e.BehaviorSubject=ce,e.AsyncSubject=ae,e.ReplaySubject=le,e.Scheduler=ke,e.Notification=X,Object.defineProperty(e,"__esModule",{value:!0})});
