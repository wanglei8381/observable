!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Rx={})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0},o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},u=Object.prototype,c=function(e){return u.toString.call(e)};function l(e){if(n=void 0===(r=e)?"undefined":t(r),null==r||"object"!==n&&"function"!==n)return!1;var r,n,i=c(e);return"[object Function]"===i||"[object AsyncFunction]"===i||"[object GeneratorFunction]"===i||"[object Proxy]"===i}var h=0,a={},f=function(){function e(){r(this,e),this._closed=!1,this.observers=[]}return n(e,[{key:"unsubscribe",value:function(){this._unsubscribe&&this._unsubscribe(),this.observers.forEach(function(e){e.unsubscribe()}),this.observers=[],this._closed=!0}},{key:"add",value:function(t){l(t)?this.observers.push({unsubscribe:t}):t instanceof e&&this.observers.push(t)}},{key:"closed",get:function(){return this._closed}}]),e}(),b=function(e){function t(e,n,i){r(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e&&(o._next=e),n&&(o._error=n),i&&(o._complete=i),o.active=!0,o}return o(t,f),n(t,[{key:"next",value:function(e){if(this.active&&this._next)try{this._next(e)}catch(e){this.unsubscribe(),this.errorSource="next",this.errorValue=e}}},{key:"error",value:function(e){if(this.active){if(!this._error)throw this.unsubscribe(),this.errorSource="error",e;try{this._error(e)}catch(e){throw this.unsubscribe(),this.errorSource="error",e}this.unsubscribe()}}},{key:"complete",value:function(){this.active&&(this._complete&&this._complete(),this.unsubscribe())}},{key:"add",value:function(e){this.active?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e):l(e)?e():e instanceof f&&e.unsubscribe()}},{key:"_unsubscribe",value:function(){this.active=!1}}]),t}(),y=new b;function d(e,r,n){var i,o=e;return null==e?y:e instanceof b?e:(null!=(i=e)&&"object"===(void 0===i?"undefined":t(i))&&(o=e.next,r=e.error,n=e.complete),new b(o,r,n))}var v,p=(v=void 0,"function"==typeof Symbol?Symbol.observable?v=Symbol.observable:(v=Symbol("observable"),Symbol.observable=v):v="@@observable",v),_=function(){function e(t){r(this,e),this._subscriber=t}return n(e,[{key:"lift",value:function(t){var r=new e;return r.source=this,r.operator=t,r}},{key:"subscribe",value:function(e,t,r){var n=d(e,t,r);if(this.operator){var i=d(this.operator(n));n.add(i),this.source.subscribe(i)}else this._subscriber&&n.add(this._trySubscribe(n));if(n.errorValue&&"next"===n.errorSource)throw n.errorValue;return n}},{key:"_trySubscribe",value:function(e){try{return this._subscriber(e)}catch(t){e.syncError=t,e.error(t)}}},{key:p,value:function(){return this}}],[{key:"create",value:function(t){return new e(t)}}]),e}();_.prototype.do=function(e,t,r){return this.lift((n=e,i=t,o=r,function(e){var t={next:function(t){n(t),e.next(t)},error:function(t){i&&i(t),e.error(t)},complete:function(){o&&o(),e.complete()}};return t}));var n,i,o};var g=function(e){function t(e,n){r(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.scheduler=e,i.work=n,i}return o(t,f),n(t,[{key:"schedule",value:function(e,t){return this}}]),t}(),O=function(e){function t(){var e,n,i;r(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.id=null,i.state=void 0,i.delay=0,i.pending=!1,s(i,n)}return o(t,g),n(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e,this.delay=t,this.pending=!0;var r=this.scheduler,n=this.id;return null!=n&&(n=this.recycleAsyncId(r,n,t)),n||(n=this.requestAsyncId(r,n,t)),this.id=n,this}},{key:"recycleAsyncId",value:function(e,t,r){if(null!==r&&this.delay===r&&!1===this.pending)return t;clearInterval(t)}},{key:"requestAsyncId",value:function(e,t,r){return setInterval(e.flush.bind(e,this),r)}},{key:"execute",value:function(e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var t=this._execute(e);if(t)return t;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e){try{this.work(e)}catch(e){return this.unsubscribe(),e}}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler.actions,r=t.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&t.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(this.scheduler,e,null)),this.delay=null}}]),t}(),k=function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,O),n(t,[{key:"requestAsyncId",value:function(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=o&&o>0?i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,r,o):(e.actions.push(this),e.scheduled||(e.scheduled=(n=e.flush.bind(e,null),a[++h]=n,Promise.resolve().then(function(){var e=a[h];e&&e()}),h)))}},{key:"recycleAsyncId",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&n>0||null===n&&this.delay>0)return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"recycleAsyncId",this).call(this,e,r,n);0===e.actions.length&&(delete a[r],e.scheduled=void 0)}}]),t}(),w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;r(this,e),this.SchedulerAction=t,this.now=n}return n(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2];return new this.SchedulerAction(this,e).schedule(r,t)}}]),e}();w.now=Date.now;var m=function(e){function t(){var e,n,i;r(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.actions=[],i.active=!1,i.scheduled=void 0,s(i,n)}return o(t,w),n(t,[{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{this.active=!0;var r=void 0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}}]),t}(),j=new(function(e){function t(){return r(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,m),n(t,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t=this.actions,r=void 0;e=e||t.shift();do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}]),t}())(k),S={async:new m(O),asap:j};e.Observable=_,e.Subscription=f,e.Subscriber=b,e.emptySubscriber=y,e.toSubscriber=d,e.Scheduler=S,Object.defineProperty(e,"__esModule",{value:!0})});
